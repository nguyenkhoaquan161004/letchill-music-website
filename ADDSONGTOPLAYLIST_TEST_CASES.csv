Test Case ID,Test Case Description,PreRequisites,Step,Steps to Perform,Step Expected Result,Test Case Expected Result,Actual Result,Status,Type,Note,Platform
FT17-01,Duplicate detection - show toast MSG 16 when song exists,"User logged in, Playlist created with songs","Bước 1","Check if song already exists in playlist by sending POST request to /api/playlistsongs/check endpoint","Endpoint receives request with playlistId, songId, and uid parameters","API returns {exists: true, message: 'Song already exists'}","Passed","Passed","Automation","Validates BR17 requirement - duplicate check","Frontend"
FT17-01,Duplicate detection - show toast MSG 16 when song exists,"User logged in, Playlist created with songs","Bước 2","Verify that the API correctly identifies the duplicate song in the playlist","Response is received with exists: true flag","System determines the song is already in the playlist","Passed","Passed","Automation","BR17 duplicate detection logic","Frontend"
FT17-01,Duplicate detection - show toast MSG 16 when song exists,"User logged in, Playlist created with songs","Bước 3","Display error toast notification MSG 16 to user indicating duplicate","Toast notification component is triggered","User sees toast message 'Bài hát này đã có trong danh sách phát' (MSG 16)","Passed","Passed","Automation","BR17 error messaging - prevent duplicate adds","Frontend"
FT17-02,New song detection - proceed to add when song not exists,"User logged in, Playlist opened, Song not in playlist","Bước 1","Check if song exists in playlist by sending POST request to /api/playlistsongs/check","Endpoint receives request with playlistId, songId, and uid parameters","API returns {exists: false, message: 'Song not found'}","Passed","Passed","Automation","Validates BR17 - clear path for new songs","Frontend"
FT17-02,New song detection - proceed to add when song not exists,"User logged in, Playlist opened, Song not in playlist","Bước 2","Verify API correctly identifies song is new (not in playlist)","Response is received with exists: false flag","System determines song is NOT in the playlist","Passed","Passed","Automation","BR17 new song verification","Frontend"
FT17-02,New song detection - proceed to add when song not exists,"User logged in, Playlist opened, Song not in playlist","Bước 3","Proceed to add song by continuing to BR18 logic","No error is thrown, add operation continues","System moves forward to add the new song to playlist","Passed","Passed","Automation","BR17 clear for adding new songs","Frontend"
FT17-03,Successful add - song added to playlist with current date,"User logged in, Duplicate check passed, Song data ready","Bước 1","Send POST request to /api/playlistsongs with playlistId, songId, and uid","Request body includes playlistId, songId, uid, and current timestamp","Backend receives the add request and validates parameters","Passed","Passed","Automation","Validates BR18 step 1 - add initiation","Frontend"
FT17-03,Successful add - song added to playlist with current date,"User logged in, Duplicate check passed, Song data ready","Bước 2","Backend creates new record in CT_DanhSachPhat table with current date","Database INSERT operation executes for the playlist-song relationship","New row is added with MaDanhSach, MaBaiHat, NgayThem = current date","Passed","Passed","Automation","BR18 step 2 - database persistence","Frontend"
FT17-03,Successful add - song added to playlist with current date,"User logged in, Duplicate check passed, Song data ready","Bước 3","Verify song is successfully added to playlist with addedDate timestamp","Response returns {success: true, playlistId, songId, addedDate}","Frontend receives confirmation with songId, playlistId, and addedDate (current date)","Passed","Passed","Automation","BR18 verification - song added with timestamp","Frontend"
FT17-04,Metadata update - increment song count and update modified date,"User added song to playlist, Playlist metadata ready","Bước 1","Increment playlist song count (SoLuongBaiHat) by 1","Current count retrieved (e.g., 5), increment logic applied","New count = 6","Passed","Passed","Automation","Validates BR18 step 3 - count increment","Frontend"
FT17-04,Metadata update - increment song count and update modified date,"User added song to playlist, Playlist metadata ready","Bước 2","Update playlist modified date (NgayChinhSua) to current timestamp","Backend receives PATCH request to /api/playlist/{playlistId}/metadata","Database UPDATE executes setting NgayChinhSua = current date/time","Passed","Passed","Automation","BR18 step 3 - timestamp update","Frontend"
FT17-04,Metadata update - increment song count and update modified date,"User added song to playlist, Playlist metadata ready","Bước 3","Verify metadata update response contains updated songCount and modifiedDate","PATCH response returns {playlistId, songCount: 6, modifiedDate: current timestamp}","Playlist metadata reflects song count increased by 1 and modification timestamp updated","Passed","Passed","Automation","BR18 metadata verification","Frontend"
FT17-05,Success notification - show MSG 17 after successful add,"Song successfully added to playlist, API returned success response","Bước 1","Prepare success notification message after add completes","Response from POST /api/playlistsongs returns {success: true, message: 'Thêm bài hát vào danh sách phát thành công!'}","Success response received with MSG 17 content","Passed","Passed","Automation","Validates BR18 step 4 - success message prep","Frontend"
FT17-05,Success notification - show MSG 17 after successful add,"Song successfully added to playlist, API returned success response","Bước 2","Display success toast notification MSG 17 to user","Toast component renders with message 'Thêm bài hát vào danh sách phát thành công!' (MSG 17)","User sees success notification on screen","Passed","Passed","Automation","BR18 step 4 - success notification display","Frontend"
FT17-05,Success notification - show MSG 17 after successful add,"Song successfully added to playlist, API returned success response","Bước 3","Verify dialog closes and playlist list refreshes with new song","Dialog component closes, playlist data is refreshed from backend or state updated","Song appears in playlist list, dialog is closed","Passed","Passed","Automation","BR18 final step - UI updated and dialog closed","Frontend"
FT17-06,Failed add - handle error and keep dialog open,"User attempted to add song, API returned error response","Bước 1","Send add request and receive error response from backend","Request sent to /api/playlistsongs with response {ok: false, error: 'Permission denied'}","Error response received with error message and status code","Passed","Passed","Automation","Validates error handling BR18","Frontend"
FT17-06,Failed add - handle error and keep dialog open,"User attempted to add song, API returned error response","Bước 2","Process error response and display appropriate error message to user","Toast/alert component renders with error message","User sees error notification (e.g., 'Không thể thêm bài hát, vui lòng thử lại')","Passed","Passed","Automation","Error notification to user","Frontend"
FT17-06,Failed add - handle error and keep dialog open,"User attempted to add song, API returned error response","Bước 3","Keep dialog open to allow user to retry or cancel operation","Dialog remains visible, not dismissed after error","User can click Close button or retry the add operation","Passed","Passed","Automation","Error handling - dialog remains open","Frontend"
FT17-07,Duplicate detection API - return error when song exists,"Playlist initialized, Database has existing songs","Bước 1","Send POST request to /api/playlistsongs endpoint with uid parameter","Request sent with playlistId, songId, and uid query parameter","Backend receives request and validates all required parameters","Passed","Passed","Automation","Validates BR17 API endpoint","Backend"
FT17-07,Duplicate detection API - return error when song exists,"Playlist initialized, Database has existing songs","Bước 2","Backend checks if song already exists in playlist CT_DanhSachPhat table","Query executed: SELECT * FROM CT_DanhSachPhat WHERE MaDanhSach = ? AND MaBaiHat = ?","Database returns existing record if song is in playlist","Passed","Passed","Automation","BR17 API step 1 - duplicate check query","Backend"
FT17-07,Duplicate detection API - return error when song exists,"Playlist initialized, Database has existing songs","Bước 3","Return error response indicating duplicate found","Response returns status 400 with error message about duplicate","Request validation shows duplicate song cannot be added","Passed","Passed","Automation","BR17 API duplicate detection","Backend"
FT17-08,New song detection API - proceed when song not exists,"Playlist initialized, Song not in database","Bước 1","Send POST request to /api/playlistsongs with valid uid and songId not in playlist","Request parameters are valid and song is not yet in playlist","Backend receives request and validates parameters successfully","Passed","Passed","Automation","Validates BR17 API - new song path","Backend"
FT17-08,New song detection API - proceed when song not exists,"Playlist initialized, Song not in database","Bước 2","Backend queries CT_DanhSachPhat to check if song exists in playlist","Query: SELECT * FROM CT_DanhSachPhat WHERE MaDanhSach = ? AND MaBaiHat = ?","Query returns no results (song not found in playlist)","Passed","Passed","Automation","BR17 API step 1 - no duplicate found","Backend"
FT17-08,New song detection API - proceed when song not exists,"Playlist initialized, Song not in database","Bước 3","Continue to add song logic since no duplicate detected","No error thrown, add operation proceeds to BR18","System allows adding the new song to continue","Passed","Passed","Automation","BR17 API clear for new song","Backend"
FT17-09,Successful add API - song added to playlist with current date,"Song verified as new, Add operation initiated, Database ready","Bước 1","Backend receives POST request to /api/playlistsongs with song and playlist data","Request body contains valid playlistId, songId, uid, and timestamp","Parameters are validated by backend API","Passed","Passed","Automation","Validates BR18 API step 1","Backend"
FT17-09,Successful add API - song added to playlist with current date,"Song verified as new, Add operation initiated, Database ready","Bước 2","Backend executes INSERT into CT_DanhSachPhat table with current date","Prisma/ORM INSERT query: {MaDanhSach, MaBaiHat, NgayThem: new Date()}","New playlist-song record created in database with current timestamp","Passed","Passed","Automation","BR18 API step 2 - database insert","Backend"
FT17-09,Successful add API - song added to playlist with current date,"Song verified as new, Add operation initiated, Database ready","Bước 3","Return success response with added song details and timestamp","API response status 200 with {success: true, playlistId, songId, addedDate: ISO timestamp}","Frontend receives confirmation with all song details and add date","Passed","Passed","Automation","BR18 API verification - add successful","Backend"
FT17-10,Metadata update API - increment song count and update modified date,"Song added to playlist, Metadata update triggered","Bước 1","Backend receives PATCH request to update playlist metadata after song add","Request to /api/playlist/{playlistId}/metadata with uid parameter","Backend validates playlist ownership and parameters","Passed","Passed","Automation","Validates BR18 API metadata update","Backend"
FT17-10,Metadata update API - increment song count and update modified date,"Song added to playlist, Metadata update triggered","Bước 2","Backend increments SoLuongBaiHat by 1 and updates NgayChinhSua to current date","Prisma UPDATE: {SoLuongBaiHat: count + 1, NgayChinhSua: new Date()}","Database record updated with incremented count and new timestamp","Passed","Passed","Automation","BR18 API step 3 - metadata update","Backend"
FT17-10,Metadata update API - increment song count and update modified date,"Song added to playlist, Metadata update triggered","Bước 3","Verify metadata response returns updated songCount and modifiedDate","Response {playlistId, songCount: 6, modifiedDate: ISO timestamp}","Frontend receives updated metadata confirming count and date changes","Passed","Passed","Automation","BR18 API metadata verification","Backend"
FT17-11,Permission check API - prevent non-owner from adding songs,"Different user attempts to add to playlist, Playlist exists with different owner","Bước 1","Send POST request to /api/playlistsongs with uid parameter different from playlist owner","Request body: {playlistId, songId}, Query: uid=different-user-123","Backend receives request and identifies user as non-owner","Passed","Passed","Automation","Validates BR18 API security check","Backend"
FT17-11,Permission check API - prevent non-owner from adding songs,"Different user attempts to add to playlist, Playlist exists with different owner","Bước 2","Backend retrieves playlist and checks if uid matches MaNguoiDung (owner)","Query DanhSachPhat table to verify playlist ownership","Playlist owned by different user than requesting uid","Passed","Passed","Automation","BR18 API step 2 - ownership check","Backend"
FT17-11,Permission check API - prevent non-owner from adding songs,"Different user attempts to add to playlist, Playlist exists with different owner","Bước 3","Return 403 Forbidden error response to prevent unauthorized add","API response status 403 with error message about permission denied","Request is rejected, non-owner cannot add songs to playlist","Passed","Passed","Automation","BR18 API security - deny non-owner","Backend"
FT17-12,Missing uid validation API - prevent add without user ID,"Request sent without uid parameter, Playlist and song exist","Bước 1","Send POST request to /api/playlistsongs without uid in query parameters","Request body valid but uid query parameter missing","Backend receives incomplete request","Passed","Passed","Automation","Validates BR18 API input validation","Backend"
FT17-12,Missing uid validation API - prevent add without user ID,"Request sent without uid parameter, Playlist and song exist","Bước 2","Backend validation checks for required uid parameter in request","Validation logic checks if uid exists in query params","uid parameter is missing from query string","Passed","Passed","Automation","BR18 API step 1 - missing uid detected","Backend"
FT17-12,Missing uid validation API - prevent add without user ID,"Request sent without uid parameter, Playlist and song exist","Bước 3","Return 400/401 error response for missing uid","API response status 400 or 401 with validation error message","Add operation blocked due to missing required parameter","Passed","Passed","Automation","BR18 API validation - uid required","Backend"
FT17-13,Invalid playlist validation API - prevent add to non-existent playlist,"Non-existent playlistId in request, User is authenticated","Bước 1","Send POST request to /api/playlistsongs with invalid playlistId (99999)","Request body includes non-existent playlistId: 99999, valid uid and songId","Backend receives request with invalid playlist reference","Passed","Passed","Automation","Validates BR18 API playlist validation","Backend"
FT17-13,Invalid playlist validation API - prevent add to non-existent playlist,"Non-existent playlistId in request, User is authenticated","Bước 2","Backend queries database to verify playlist exists","Query DanhSachPhat table with MaDanhSach = 99999","Playlist not found in database (query returns no results)","Passed","Passed","Automation","BR18 API step 1 - playlist not found","Backend"
FT17-13,Invalid playlist validation API - prevent add to non-existent playlist,"Non-existent playlistId in request, User is authenticated","Bước 3","Return 404 Not Found error response for invalid playlist","API response status 404 with error message about playlist not found","Add operation blocked, playlist validation failed","Passed","Passed","Automation","BR18 API validation - playlist must exist","Backend"